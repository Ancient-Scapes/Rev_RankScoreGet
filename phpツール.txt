【phpツール】

2017/09/06  Ver1.70
名前+RPの検索が必要だったが、名前のみでの検索もできるようにした。（チェックの有無で処理を分岐させる）
検索に引っかからなかった場合はメッセージを表示するようにした。


2017/05/29 Ver1.60
(JavaScriptを外部ファイルに記述)
(_ログファイルの文字列を合わせるようにした)
(ログ出力で少しデバッグが楽になるようにした）
(変数定義でおかしくなるところがあったので全体的に見直してdefineを使うようにした)
_検索結果が0件の場合エラーメッセージを表示するようにした。

2017/05/26 Ver1.50
全国1位とのスコア差を出力するようにした。
使い方に関して記載した。
チェック処理でエラーの場合メッセージボックスを表示するようにした。
入力値をセッション値に保存して連続した検索が楽になるようにした。
(ログファイルに実行結果を保存するようにした。)

_検索にヒットしなかった場合何らかの処理を行うようにした。
_検索した曲名を表示するようにした。
_出力結果をtxtファイルに出力し保存できるようにした。

2017/05/24 Ver1.00
リリース。
────────────────────────────────────────
【現在の処理のまま改良】
・理論値スコアの出力
・検索にヒットしなかった場合のエラーメッセージ表示
・検索した曲名をどこかに表示する
・コードを短くするため適宜関数化する
・RPの数字判定

【少しむずかしい】
・出力結果をtxtファイルに出力し保存できるようにする。
・ページNo.を切り替えた際に入力フォーム右側のテキストエリアか何かに検索対象曲名
　を出力する
・txtファイルに出力する際にスペースの差を統一する
・ajaxで非同期POSTして1曲毎に処理結果を途中出力する

【できるのか？】
・クッキーからログインしてスコアページへ飛び曲名ごとにスコアをすべて保存する
・ログイン処理のセキュリティに関して必ず表記する
・プログレスバーか何かを用いて現在進捗を出力
->プログレスバーの現在進捗は不可能だが、読み込み中の表示程度はできるかもしれない。

────────────────────────────────────────
【エラーメッセージ】
・プレイヤー名に公式で打てないものが使われている場合
・プレイヤー名が8文字を超えている場合
・RPが数字でない場合
・RPが4桁でない場合
・検索し全国TOP10スコアが見つからなかった場合
「$playerNameさんの全国TOP10スコアは見つかりませんでした。」
・検索は押せたが検索対象の曲が0件だった場合
「検索対象の曲の難易度が存在しません。」

────────────────────────────────────────
【使い方】
・仕様に関して説明
1.入力フォームにプレイヤー名、およびRPを入力
 ->プレイヤー名のみでは2人以上ヒットする可能性があるため
 ->RPも打たせることによってほぼ完全一致での検索を行える
 #RPとプレイヤー名が一致するケースは99%ないと思うのでこれで大丈夫
 #一応所属県まで選択させようとしたけどそれは冗長すぎる

2.難易度を選択
 ->UNLIMITED譜面を選択した場合、UNLIMITEDが存在しない譜面は検索がスルーされる
 ->同じように、EASY〜HARDが存在しない譜面は検索がスルーされる（メガロ、イスタンブール）
 ->一応MAS譜面がないのも対応できるが現状では該当する曲は存在しない

3.ページ数の選択
 ・全ページを対象にすることで発生するメリット
　一気に一覧にして見れてめっちゃ楽
　いちいちこの曲がどこにあるとか気にする必要がない
 ・デメリット
  とてつもない時間がかかる
　ボタンを押すだけで200アクセスくらいするのでサーバーに負荷がかかる可能性が非常に高い
　submitを噛ませているのでプログレスバーを表示できず長い処理は向いていない

　・ページ数を分けることで発生するメリット
　ある程度負荷を軽減することができる
　処理が速く終わり手軽に見ることができる
　・デメリット
　すべてを見ようとする場合11回処理を行われければいけない為非効率
　どの曲がどこにあるとかが感覚でしか分からない

4.実行
　ボタンを押すと検索結果が出力される。
　1ページ20曲の検索対象で処理時間はだいたい3秒程度。
　全国TOP10のスコアがあればデータの出力が行われる。
　全国TOP10スコアがなければメッセージが出力され終了する。
────────────────────────────────────────

没改善案
【改良（バージョンアップ案）】
・公式のデータをスクレイピングして一気に難易度を取得する処理を作る
・曲名->EASY
        STANDARD
        HARD
        MASTER
        UNLIMITED
のような形の配列を作りレベルを入れる　別phpで記述　requiareでそのデータを参照
・先に11ページ分のリンクと曲名をすべて持ってきてソートを行い該当するレベルのデータのみを検索にかけたい
・レベル指定をした場合難易度指定は？
・難易度指定とレベル指定を兼ねた場合は？
例:UNLIMITEDかつレベル60〜70のデータを検索
例:レベル60〜70のデータを検索（該当するレベルに応じたリンクを抽出する（同じ曲から2つ以上出すため難しい）
　
案1
曲レベルで配列を作りそこから参照（量がとても多い、メンテが面倒）
案2
曲ごとにループする際に最初にレベルを見てその全難易度を検索して該当するレベルに当てはまるものを5つまで配列に格納
曲ごとに難易度別で検索をかける

※そもそもレベル指定は該当する曲が多すぎるため却下